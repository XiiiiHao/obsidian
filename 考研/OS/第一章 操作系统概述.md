# 1.1 基本概念
## 1.1.1 OS的概念
	OS是指控制和管理整个计算机系统的硬件资源，合理组织、调度计算机的资源和工作与资源的分配，进而为用户和其他软件提供方便接口与环境的程序集合。
## 1.1.2 OS的特征
1.并发：
	同一时间间隔内发生（并行：同一时刻，CPU与I/O，I/O与I/O可以真正并行，进程的并行要多CPU或多流水线）

2.共享：
	（1）互斥共享：
	（2）同时访问：
==并发与共享是OS的两个最基本的特征==

	3.虚拟：
		时分复用技术、空分复用技术
	4.异步：
##  1.1.3 OS的目标与功能
1.管理计算机资源
	（1）处理机管理：主要是进程管理：进程控制、进程同步、进程通信、死锁处理、CPU调度等
	（2）存储器管理
	（3）文件管理
	（4）设备管理
2.作为用户与计算机硬件系统之间的接口
	（1）命令接口：联机（交互式）、脱机（批处理）命令接口
	（2）程序接口：系统调用
3.实现了对计算机资源的扩充

---
# 1.2 OS发展历程
## 1.2.1 手工操作阶段（无OS）
* 原因：人机矛盾变大
* 缺点：
	* 用户独占全机，资源利用率低
	* CPU利用率低
## 1.2.2 批处理阶段
* 目的：解决人机矛盾和CPU与I/O设备速度不匹配
* 手段：中断（进程要并发，切换进程）
* ==主要缺点==：无交互
单通道批处理OS：
* 优点：缓解人机速度矛盾
* 缺点：资源利用率依旧很低
* 特点：自动、顺序、单道

多道批处理OS：
* 技术：==多道程序设计技术==
* 优点：CPU与资源利用率高
* 缺点：用户响应时间长；无人机交互
* 特点：多道、宏观并行、微观串行

## 1.2.3 分时OS
* 特点：同时、==交互==、独立、及时

## 1.2.4 实时OS
* 硬实时、软实时
* 特点：及时（严格时限内完成）、可靠

---
# 1.3 OS的运行环境
## 1.3.1 处理器运行模式
* 内核程序与用户程序
* 指令
	* 特权：I/O、关中断、内存清零、送PSW到程序状态字寄存器、
	* 非特权：陷入（访管）指令
* 用户态与核心态
	* ==切换==：通过硬件实现
	* ==用户态：调用系统调用（可能在用户态）、==
	* ==核心态：执行系统调用、可执行除trap指令外的所有指令==
内核：
1. 时钟管理：时钟计时、时钟中断（主要工作是处理时间信息（系统时间、进程的时间片、延时、使用CPU的时间、各种定时器）以及决定要不要执行调度程序）
2. 中断机制：初衷：提高多道程序运行时的CPU利用率
3. 原语：
	1. 最接近硬件
	2. 原子性
	3. 运行快，调用频繁
	4. 定义的直接方法是关中断，跑完再打开
4. 系统控制的数据结构及处理：进程、存储器、设备管理
## 1.3.2 中断与异常
中断（外中断）：
	CPU执行指令外部的中断，如I/O结束中断、时钟中断；
	可屏蔽（INTR线）：改变屏蔽字
	不可屏蔽（NMI线）：电源掉电
	==PC值由中断隐指令自动保存、通用寄存器由OS保存、块表（TLB）和Cache由硬件保存==
异常：
* 故障：非法操作码、缺页故障、除0、运算溢出
* 自陷：条件陷阱指令、系统调用指令
* 终止：硬件故障

## 1.3.3 系统调用
步骤：
1. 系统调用号与所需参数入栈、调用系统调用指令、执行trap指令、CPU变态、硬件与OS内核程序保护被中断进程现场、压PC、PSW入栈
2. 分析调用类型、执行系统调用
3. 返回被中断进程或新进程
特点：
* 替换麻烦
* 开销大
* 不方便调试

---
# 1.4 操作系统结构
分层法：
* 优点：
	* 便于调试和验证
	* 易扩充、易维护
* 缺点：
	* 合理定义各层比较困难，难设计（最显著的不足）
	* 效率低

模块化：
* ==一个崩都崩==
* 优点：
* 缺点：

宏内核：


微内核：
* 基本功能：
	* 进程管理
	* 低级存储器管理
	* 中断和陷入处理
* 特点：
	* 扩展性与灵活性
	* 可靠性与安全性
	* 可移植性
	* 分布式计算
* 问题：性能问题

外核：

# 1.5 操作系统引导
过程：
1. 激活CPU；读取ROM里的boot程序，执行BIOS里的指令
2. 硬件自检：BIOS程序构建中断向量表；中断；通电自检;
3. 加载带有OS的硬盘：BIOS按启动顺序把OS加载到内存中
4. 加载主引导记录（MBR）：MBR的作用是告诉CPU去硬盘的哪个分区找操作系统
5. 扫描硬盘分区表，加载硬盘活动分区：
6. 加载分区引导记录（PBR）：读取活动分区的第一个扇区PBR,作用是寻找并激活分区根目录下用于引导OS的程序（启动管理器）
7. 加载启动管理器
8. 加载OS,把OS的初始化程序加载到内存中执行

# 1.6 虚拟机
* 第一类
* 第二类